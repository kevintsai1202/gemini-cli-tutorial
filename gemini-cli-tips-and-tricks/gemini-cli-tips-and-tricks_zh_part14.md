## 技巧 25：使用 GEMINI CLI GITHUB ACTION 自動化儲存庫任務

**快速用例：** 讓 Gemini 在 GitHub 上工作——使用 Gemini CLI GitHub Action 自動分類新問題並審查儲存庫中的拉取請求，充當處理日常開發任務的 AI 隊友。

Gemini CLI 不僅適用於互動式終端機會話；它還可以透過 GitHub Actions 在 CI/CD 管道中運行。Google 提供了一個現成的 Gemini CLI GitHub Action（目前處於測試階段），可整合到您的儲存庫工作流程中。

這有效地將 AI 代理部署到您 GitHub 上的專案中。它在背景中運行，由儲存庫事件觸發。例如，當有人開啟新問題時，Gemini Action 可以自動分析問題描述，應用相關標籤，甚至優先處理或建議重複項（這是「智慧問題分類」工作流程）。當拉取請求開啟時，Action 會啟動以提供 AI 程式碼審查——它將在 PR 上評論程式碼品質、潛在錯誤或風格改進的見解。這讓維護者在任何人查看 PR 之前立即獲得回饋。也許最酷的功能是按需協作：團隊成員可以在問題或 PR 評論中提及 `@gemini-cli` 並給予指令，例如「`@gemini-cli` 請為此編寫單元測試」。Action 將會接收到該指令，Gemini CLI 將嘗試滿足請求（例如，新增一個帶有新測試的提交）。這就像您的儲存庫中住著一個 AI 助理，隨時準備在被要求時執行雜務。

**設定 Gemini CLI GitHub Action 非常簡單。** 首先，確保您已在本機安裝 Gemini CLI 0.1.18 或更高版本（這可確保與 Action 的相容性）。然後，在 Gemini CLI 中運行特殊命令：`/setup-github`。此命令會在您的儲存庫中生成必要的工作流程檔案（如果需要，它會引導您完成身份驗證）。具體來說，它會在 `.github/workflows/` 下新增 YAML 工作流程檔案（用於問題分類、PR 審查等）。您需要將您的 Gemini API 金鑰新增到儲存庫的機密中（作為 `GEMINI_API_KEY`），以便 Action 可以使用 Gemini API。完成此操作並提交工作流程後，GitHub Action 就會啟動——從那時起，Gemini CLI 將根據這些工作流程自主回應新問題和 PR。

由於此 Action 本質上是以自動化方式運行 Gemini CLI，因此您可以像自訂 CLI 一樣自訂它。預設設定附帶三個工作流程（問題分類、PR 審查和一般提及觸發的助理），這些工作流程是**完全開源且可編輯的**。您可以調整 YAML 以調整 AI 的操作，甚至新增新的工作流程。例如，您可以建立一個夜間工作流程，使用 Gemini CLI 掃描您的儲存庫以查找過時的依賴項，或根據最近的程式碼更改更新 README——可能性是無限的。這裡的關鍵好處是將繁瑣或耗時的任務卸載給 AI 代理，以便人類開發人員可以專注於更困難的問題。由於它在 GitHub 的基礎設施上運行，因此無需您的干預——它確實是一個「設定即忘」的 AI 助手。

**專業技巧：** 密切關注 GitHub Actions 日誌中的 Action 輸出，以提高透明度。Gemini CLI Action 日誌將顯示它運行了哪些提示以及它進行或建議了哪些更改。這既可以建立信任，也可以幫助您改進其行為。此外，團隊已在 Action 中內建了企業級安全防護措施——例如，您可以要求 AI 在工作流程中嘗試運行的所有 shell 命令都必須經過您的允許。因此，即使在嚴肅的專案中，也請毫不猶豫地使用它。如果您想出一個很酷的自訂工作流程，使用 Gemini CLI，請考慮將其貢獻回社群——該專案歡迎在其儲存庫中提出新想法！

## 技巧 26：啟用遙測以獲取見解和可觀察性

**快速用例：** 透過開啟 Gemini CLI 內建的 OpenTelemetry 檢測功能，更深入地了解 Gemini CLI 的使用方式和效能——監控您的 AI 會話的指標、日誌和追蹤，以分析使用模式或排除故障。

對於喜歡測量和優化的開發人員來說，Gemini CLI 提供了一個可觀察性功能，可以揭示底層發生的事情。透過利用 OpenTelemetry (OTEL)，Gemini CLI 可以發出有關您會話的結構化遙測資料。這包括指標（例如使用了多少個 token、回應延遲）、所執行操作的日誌，甚至工具調用的追蹤。啟用遙測後，您可以回答以下問題：我最常使用哪個自訂命令？本週 AI 在此專案中編輯了多少次檔案？當我要求 CLI 運行測試時，平均回應時間是多少？這些資料對於了解使用模式和效能非常寶貴。團隊可以使用它來查看開發人員如何與 AI 助理互動以及可能存在的瓶頸。

預設情況下，遙測是關閉的（Gemini 尊重隱私和效能）。您可以透過在 `settings.json` 中設定 `“telemetry.enabled”: true` 或透過使用 `--telemetry` 標誌啟動 Gemini CLI 來選擇啟用。此外，您可以選擇遙測資料的目標：它可以記錄在本機或傳送到 Google Cloud 等後端。為了快速入門，您可以設定 `“telemetry.target”: “local”`——這樣，Gemini 將簡單地將遙測資料寫入本機檔案（預設情況下）或透過 `[”outfile”]` 指定的自訂路徑。本機遙測包括您可以解析或饋送到工具中的 JSON 日誌。為了更強大的監控，請設定 `“target”: “gcp”` (Google Cloud) 或甚至與 Jaeger 或 Datadog 等其他 OpenTelemetry 相容系統整合。事實上，Gemini CLI 的 OTEL 支援是供應商中立的——您可以將資料匯出到您喜歡的幾乎任何可觀察性堆疊（Google Cloud Operations、Prometheus 等）。Google 為 Cloud 提供了一條簡化的路徑：如果您指向 GCP，CLI 可以將資料直接傳送到您專案中的 Cloud Logging 和 Cloud Monitoring，您可以在其中使用常用的儀表板和警報工具。

**您可以獲得哪些見解？** 遙測捕獲工具執行、錯誤和重要里程碑等事件。它還記錄指標，例如提示處理時間和每個提示的 token 計數。對於使用分析，您可以匯總您的團隊中每個斜線命令的使用次數，或程式碼生成被調用的頻率。對於效能監控，您可以追蹤回應是否變慢，這可能表示達到 API 速率限制或模型更改。對於偵錯，您可以查看工具拋出的錯誤或異常（例如，`run_shell_command` 失敗）以及上下文日誌。所有這些資料都可以在您將其傳送到 Google Cloud 的監控等平台時進行視覺化——例如，您可以建立一個「每日使用的 token 數」或「工具 X 的錯誤率」的儀表板——這對於企業環境中確保一切順利運行特別有幫助。

啟用遙測確實會引入一些開銷（額外的資料處理），因此您可能不會在個人使用時始終保持其開啟。但是，它對於偵錯會話或間歇性健康檢查非常有用。一種方法是在 CI 伺服器或團隊的共享環境中啟用它以收集統計資料，同時在不需要時在本機關閉它。請記住，您可以隨時即時切換它：更新設定並在需要時使用 `/memory refresh` 重新載入，或使用 `--telemetry` 標誌重新啟動 Gemini CLI。此外，所有遙測都在您的控制之下——它尊重您的端點和憑證的環境變數，因此資料只會傳送到您打算傳送的地方。此功能將 Gemini CLI 從黑盒子轉變為天文台，揭示 AI 代理如何與您的世界互動，以便您可以不斷改進這種互動。
